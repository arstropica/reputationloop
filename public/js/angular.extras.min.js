angular.module("ui.bootstrap-slider",[]).directive("slider",["$parse","$timeout","$rootScope",function($parse,$timeout,$rootScope){return{restrict:"AE",replace:!0,template:'<div><input class="slider-input" type="text" style="width:100%" /></div>',require:"ngModel",scope:{max:"=",min:"=",step:"=",value:"=",ngModel:"=",ngDisabled:"=",range:"=",sliderid:"=",ticks:"=",ticksLabels:"=",ticksSnapBounds:"=",ticksPositions:"=",scale:"=",focus:"=",formatter:"&",onStartSlide:"&",onStopSlide:"&",onSlide:"&"},link:function($scope,element,attrs,ngModelCtrl,$compile){function initSlider(){function setOption(key,value,defaultValue){options[key]=value||defaultValue}function setFloatOption(key,value,defaultValue){options[key]=value||0===value?parseFloat(value):defaultValue}function setBooleanOption(key,value,defaultValue){options[key]=value?value+""=="true":defaultValue}function getArrayOrValue(value){return angular.isString(value)&&0===value.indexOf("[")?angular.fromJson(value):value}var options={};setOption("id",$scope.sliderid),setOption("orientation",attrs.orientation,"horizontal"),setOption("selection",attrs.selection,"before"),setOption("handle",attrs.handle,"round"),setOption("tooltip",attrs.sliderTooltip||attrs.tooltip,"show"),setOption("tooltip_position",attrs.sliderTooltipPosition,"top"),setOption("tooltipseparator",attrs.tooltipseparator,":"),setOption("ticks",$scope.ticks),setOption("ticks_labels",$scope.ticksLabels),setOption("ticks_snap_bounds",$scope.ticksSnapBounds),setOption("ticks_positions",$scope.ticksPositions),setOption("scale",$scope.scale,"linear"),setOption("focus",$scope.focus),setFloatOption("min",$scope.min,0),setFloatOption("max",$scope.max,10),setFloatOption("step",$scope.step,1);var strNbr=options.step+"",dotPos=strNbr.search(/[^.,]*$/),decimals=strNbr.substring(dotPos);if(setFloatOption("precision",attrs.precision,decimals.length),setBooleanOption("tooltip_split",attrs.tooltipsplit,!1),setBooleanOption("enabled",attrs.enabled,!0),setBooleanOption("naturalarrowkeys",attrs.naturalarrowkeys,!1),setBooleanOption("reversed",attrs.reversed,!1),setBooleanOption("range",$scope.range,!1),options.range){if(angular.isArray($scope.value))options.value=$scope.value;else if(angular.isString($scope.value)){if(options.value=getArrayOrValue($scope.value),!angular.isArray(options.value)){var value=parseFloat($scope.value);isNaN(value)&&(value=5),value<$scope.min?(value=$scope.min,options.value=[value,options.max]):value>$scope.max?(value=$scope.max,options.value=[options.min,value]):options.value=[options.min,options.max]}}else options.value=[options.min,options.max];$scope.ngModel=options.value}else setFloatOption("value",$scope.value,5);attrs.formatter&&(options.formatter=function(value){return $scope.formatter({value:value})}),"$"in window&&$.fn.slider&&($.fn.slider.constructor.prototype.disable=function(){this.picker.off()},$.fn.slider.constructor.prototype.enable=function(){this.picker.on()}),element[0].__slider&&element[0].__slider.destroy();var slider=new Slider(element[0].getElementsByClassName("slider-input")[0],options);element[0].__slider=slider;var updateEvent=getArrayOrValue(attrs.updateevent);updateEvent=angular.isString(updateEvent)?[updateEvent]:["slide"],angular.forEach(updateEvent,function(sliderEvent){slider.on(sliderEvent,function(ev){ngModelCtrl.$setViewValue(ev)})}),slider.on("change",function(ev){ngModelCtrl.$setViewValue(ev.newValue)});var sliderEvents={slideStart:"onStartSlide",slide:"onSlide",slideStop:"onStopSlide"};return angular.forEach(sliderEvents,function(sliderEventAttr,sliderEvent){var fn=$parse(attrs[sliderEventAttr]);slider.on(sliderEvent,function(ev){$scope[sliderEventAttr]&&fn($scope.$parent,{$event:ev,value:ev})})}),angular.isFunction(ngDisabledDeregisterFn)&&(ngDisabledDeregisterFn(),ngDisabledDeregisterFn=null),ngDisabledDeregisterFn=$scope.$watch("ngDisabled",function(value){value?slider.disable():slider.enable()}),angular.isFunction(ngModelDeregisterFn)&&ngModelDeregisterFn(),ngModelDeregisterFn=$scope.$watch("ngModel",function(value){$scope.range?slider.setValue(value):slider.setValue(parseFloat(value)),slider.relayout()},!0),slider}var ngModelDeregisterFn,ngDisabledDeregisterFn,slider=initSlider(),watchers=["min","max","step","range","scale"];angular.forEach(watchers,function(prop){$scope.$watch(prop,function(){slider=initSlider()})}),$scope.$on("slider:relayout",function(){slider.relayout()})}}}]);